هذا اقتراح انتشوف ايه الانسب واعملة بحيث لا نضر بالمنصة التوجيه المُلزِم لنظام “نسيت كلمة المرور”

(Forgot Password Security & UX Mandate)

1. المبدأ الحاكم

نظام “نسيت كلمة المرور” جزء سيادي من أمن المنصة وليس ميزة ثانوية.

أي تنفيذ يسمح بالتخمين، التسريب، أو كشف وجود الحساب مرفوض تمامًا.

2. بدء العملية (Request Reset)

المدخل الوحيد المسموح:

بريد إلكتروني أو رقم هاتف (حسب سياسة المنصة).

يُمنع منعًا باتًا:

إظهار ما إذا كان الحساب موجودًا أم لا.

الرسالة للمستخدم دائمًا:

“إذا كانت البيانات صحيحة، ستصلك رسالة لإعادة التعيين.”

3. إنشاء رمز / رابط إعادة التعيين

يجب أن يكون:

عشوائيًا.

فريدًا.

غير قابل للتخمين.

الصلاحية:

قصيرة ومحددة زمنيًا (مثال: 10–15 دقيقة).

الاستخدام:

مرة واحدة فقط (Single-Use).

التخزين:

يُخزَّن مُجزّأ (Hashed) وليس نصًا صريحًا.

4. قناة الإرسال

يُرسل الرابط أو الرمز عبر:

بريد إلكتروني موثوق أو SMS مشفر.

يُمنع:

عرض الرمز داخل المنصة.

نسخه أو إعادة إظهاره.

5. صفحة إعادة تعيين كلمة المرور

الوصول:

فقط عبر الرابط الصحيح وغير المنتهي.

المتطلبات:

إدخال كلمة مرور جديدة + تأكيد.

التحقق:

سياسة كلمات مرور قوية (طول، تعقيد، منع كلمات شائعة).

لا يُسمح:

باستخدام كلمة مرور سابقة.

بتجاوز التحقق بأي حال.

6. ما بعد إعادة التعيين (Post-Reset Security)

إلغاء جميع الجلسات النشطة فورًا.

إعادة توليد:

رموز الجلسات.

رموز التحقق.

إشعار المستخدم:

“تم تغيير كلمة المرور بنجاح”.

تسجيل أمني:

وقت، IP تقريبي، نوع الجهاز (بدون كشف للمستخدمين).

7. الحماية من الإساءة والهجمات

فرض:

Rate Limiting على طلبات إعادة التعيين.

تأخير تصاعدي عند التكرار.

دعم:

CAPTCHA ذكي عند الاشتباه.

مراقبة:

محاولات غير طبيعية أو جماعية.

8. التوافق مع الجوال

النموذج والصفحات:

Mobile-First.

إدخال سهل بيد واحدة.

الرسائل:

واضحة، قصيرة، وغير تقنية.

9. الاستثناءات والصلاحيات

حساب المالك / السيادي:

لا يستخدم نفس مسار المستخدمين.

له آلية استعادة منفصلة، أكثر تشددًا، ومراقَبة يدويًا.

لا يُسمح:

لموظف أو نظام آلي بتغيير كلمة مرور حساب سيادي دون توثيق.

10. صيغة الإلزام

أي نظام “نسيت كلمة المرور” يكشف وجود الحساب، يسمح بإعادة استخدام الرمز، أو لا يُلغي الجلسات النشطة يُعد خرقًا أمنيًا مانعًا للإطلاق التجاري.